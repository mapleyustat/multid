#!/bin/sh

prog=tBlockTri2
out=/tmp/"$prog$$.out"
correct_out=/tmp/"$prog$$correct.out"
abserr=1.e-10

cat > "$correct_out" << "END"
M before:
lower:
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
diag:
1 0
0 1
1 0
0 1
1 0
0 1
1 0
0 1
1 0
0 1
1 0
0 1
upper:
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
y before:
0 1
0.866025 0.5
0.866025 -0.5
0 -1
-0.866025 -0.5
-0.866025 0.5
M after:
lower:
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
-0.4 -0.04
-0.04 -0.4
diag:
1 0
0 1
0.8416 0
0 0.8416
0.811787 0
0 0.811787
0.804875 0
0 0.804875
0.803199 0
0 0.803199
0.802789 0
0 0.802789
upper:
-0.4 0.04
0.04 -0.4
-0.4 0.04
0.04 -0.4
-0.475285 0.0475285
0.0475285 -0.475285
-0.49274 0.049274
0.049274 -0.49274
-0.496972 0.0496972
0.0496972 -0.496972
-0.498008 0.0498008
0.0498008 -0.498008
y after:
0 1
1.07655 1.06939
1.64997 -0.035947
0.8182 -1.1783
-0.729429 -1.16856
-1.20454 0.00339708
x:
0.765846 1.15219
1.97239 0.577719
1.79938 -0.85454
0.138492 -1.64746
-1.47687 -1.09173
-1.50044 0.0042316
M*x:
0 1
0.866025 0.5
0.866025 -0.5
0 -1
-0.866025 -0.5
-0.866025 0.5
M*x - y_before:
0 0
0 0
0 0
0 0
0 0
0 0
END
"$prog" > "$out"
if ndiff -abserr $abserr "$correct_out" "$out" > /dev/null 2>&1; then
	rm -f "$correct_out" "$out"
	exit 0
fi
exit 1
